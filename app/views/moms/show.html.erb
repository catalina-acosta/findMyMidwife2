<div class="container">
  <div>
    <%= cl_image_tag @mom.photo.key, class:"show-img center mt-2"%>
  </div>
    <% if current_user.is_midwife? %>
      <div class="midwife-info-card">
    <% else %>
      <div class="mom-info-card">
    <% end %>
      <p><i class="fa fa-user"></i>  <strong><%= @mom.user.first_name %> <%= @mom.user.last_name %></strong></p>
      <p><i class="fa fa-location-dot"></i>   <%= @mom.user.address %></p>
      <p><i class="fa fa-phone"></i>   <%= @mom.phone %></p>
      <p> <%= @mom.bio %></p>
      <div style="width: 100%; height: 150px; border: 1px; border-style: solid;"
        data-controller="map"
        data-map-markers-value="<%= @markers.to_json %>"
        data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
  </div>
  <% if current_user.mom == @mom %>
    <% if !current_user.is_midwife && current_user.mom= @mom%>
          <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#profile">
              Edit Profile
            </button>

            <!-- Modal -->
            <div class="modal fade" id="profile" tabindex="-1" aria-labelledby="noteModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Edit profile</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <%= simple_form_for(@mom) do |f| %>
                    <%= f.input :phone, class: 'btn btn-flat' %>
                    <%= f.input :due_date, as: :date, html5: true, class: 'btn btn-flat' %>
                    <%= f.input :photo, as: :file, class: 'btn btn-flat' %>
                    <%= f.submit class: "btn btn-outline-info" %>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
        <% end %>
  <% end %>
    <% if current_user.midwife %>
        <% current_user.midwife.bookings.each do |booking| %>
          <% if @mom == booking.mom && booking.confirmed? %>
            <%= simple_form_for([@mom, @note]) do |f| %>
              <%= f.input :content, label: 'Notes', placeholder: 'Add your notes here!' %>
              <%= f.submit class: "btn btn-primary" %>
            <% end %>
            <% @mom.notes.each do |note| %>
            <div class="inner-card" style="border:1px; border-style:solid; border-radius: 0%; padding: 5px 5px; margin-top: 5px;">
              <p><%= note.content %></p>
            </div>
              <!-- Button trigger modal -->

              <div class="mb-5 pb-2">
                <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#noteModal<%= note.id %>">
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>
                <%= link_to note_path(note), data: {turbo_method: :delete, confirm: "Are you sure you want to remove this note?"} do %>
                <i class="fa-regular fa-trash-can"></i>
                <% end %>
              </div>
            </div>


              <!-- Modal -->
              <div class="modal fade" id="noteModal<%= note.id %>" tabindex="-1" aria-labelledby="noteModalLabel<%= note.id %>" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5" id="exampleModalLabel">Edit Note</h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <%= simple_form_for(note) do |f| %>
                        <%= f.input :content, label: 'Notes', placeholder: 'Add your notes here!' %>
                        <%= f.submit class: "btn btn-outline-info" %>
                      <% end %>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
</div>
